M.availability_gps=M.availability_gps||{};M.availability_gps.vals=["accuracy","longitude","latitude","persistent","reveal","revealname"];M.availability_gps.form=Y.Object(M.core_availability.plugin);M.availability_gps.form.initInner=function(c,f,e,a,d,b){console.log("initInner: ",c,f,e,a,d,b);this.nodesSoFar=0;require(["core/url"],function(i){var h,g;h=document.createElement("link");h.href=i.relativeUrl("/blocks/gps/css/leaflet.css");h.type="text/css";h.rel="stylesheet";h.media="screen,print";g=document.createElement("link");g.href=i.relativeUrl("/blocks/gps/css/main.css");g.type="text/css";g.rel="stylesheet";g.media="screen,print";document.getElementsByTagName("head")[0].appendChild(h);document.getElementsByTagName("head")[0].appendChild(g)})};M.availability_gps.form.getNode=function(q){var n,j,r,k,g,p;p=M.str.availability_gps;for(n=0;n<M.availability_gps.vals.length;n++){if(!q[M.availability_gps.vals[n]]){q[M.availability_gps.vals[n]]=0}}var o="require(['block_gps/geoassist'], function(helper) { helper.init(true);});";var d="require(['block_gps/geoassist'], function(helper) { helper.current(this); });";var h=(q.persistent==1)?' checked="checked"':"";var f=(q.reveal==1)?' checked="checked"':"";var m=(q.revealname==1)?' checked="checked"':"";this.nodesSoFar++;j=[];j.push('<div class="availability_gps">');j.push('    <div class="alert alert-info">'+p.notify_block+"</div>");j.push('    <div class="row">');j.push('        <div class="col-md-2">');j.push('            <a href="#" onclick="'+o+'; return false;" class="btn btn-secondary" style="text-align: center;">');j.push('                <i class="fa fa-map" style="font-size: 30px; vertical-align: middle;"></i><br />');j.push(p.selectfrommap);j.push("            </a>");j.push("        </div>");j.push('        <div class="col-md-5" style="display: flex;">');j.push("            <div>");j.push('                <label style="height: 1.3em;">'+p.latitude+"</label><br />");j.push("                <label>"+p.longitude+"</label><br />");j.push("                <label>"+p.accuracy+"</label>");j.push("            </div>");j.push("            <div>");j.push('                <input type="text" name="latitude" value="'+q.latitude+'" size="18" style="width: 100%; max-width: 160px;"/><br />');j.push('                <input type="text" name="longitude" value="'+q.longitude+'" size="18" style="width: 100%; max-width: 160px;"/><br />');j.push('                <select name="accuracy" style="width: 100%; max-width: 160px;">');var r=[5,10,50,100,500,1000,5000,10000,20000];var c=" "+p.meters;var e=" "+p.kilometers;var i=["5"+c,"10"+c,"50"+c,"100"+c,"500"+c,"1"+e,"5"+e,"10"+e,"20"+e];for(n=0;n<r.length;n++){g=((q.accuracy==r[n])?" selected":"");j.push('       <option value="'+r[n]+'"'+g+"> "+i[n]+"</option>")}j.push("                </select>");j.push("            </div>");j.push("        </div>");j.push('        <div class="col-md-5">');j.push('            <input name="persistent" type="checkbox"'+h+" /> "+p.persistent+"<br />");j.push('            <input name="reveal" type="checkbox"'+f+" /> "+p.reveal+"<br />");j.push('            <input name="revealname" type="checkbox"'+m+" /> "+p.revealname);j.push("        </div>");j.push("    </div>");j.push('    <div class="hidden" id="availability_gps_map" style="height: 440px; border: 1px solid #AAA;">');j.push('        <div style="position: absolute; z-index: 999; right: 15px; top: 15px;">');j.push('            <a href="#" onclick="'+d+'; return false;" class="btn btn-primary">');j.push('                <i class="fa fa-map-marker"></i>&nbsp;'+p.current_location_set);j.push("            </a>");j.push("        </div>");j.push("    </div>");j.push("</div>");var b=Y.Node.create(j.join(""));if(!M.availability_gps.form.addedEvents){M.availability_gps.form.addedEvents=true;var l=Y.one("#fitem_id_availabilityconditionsjson");l.delegate("change",function(){M.core_availability.form.update();require(["block_gps/geoassist"],function(a){a.initIfShown()})},".availability_gps select");l.delegate("click",function(){M.core_availability.form.update();require(["block_gps/geoassist"],function(a){a.initIfShown()})},".availability_gps input[type=checkbox]");l.delegate("valuechange",function(){M.core_availability.form.update();require(["block_gps/geoassist"],function(a){a.initIfShown()})},".availability_gps input")}M.availability_gps.node=b;return b};M.availability_gps.form.fillValue=function(e,d){var c,b;for(b=0;b<M.availability_gps.vals.length;b++){var f=M.availability_gps.vals[b];c=d.one("*[name="+f+"]");if(["persistent","reveal","revealname"].indexOf(f)>-1){e[f]=(c.get("checked")?1:0)}else{if(c){e[f]=c.get("value")}}}};