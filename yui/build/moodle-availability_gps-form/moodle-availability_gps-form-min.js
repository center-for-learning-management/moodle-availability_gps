YUI.add("moodle-availability_gps-form",function(b,a){M.availability_gps=M.availability_gps||{};M.availability_gps.vals=["accuracy","longitude","latitude","persistent","reveal","revealname"];M.availability_gps.form=b.Object(M.core_availability.plugin);M.availability_gps.form.initInner=function(e,h,g,c,f,d){console.log("initInner: ",e,h,g,c,f,d);this.nodesSoFar=0;require(["core/url"],function(k){var j,i;j=document.createElement("link");j.href=k.relativeUrl("/blocks/gps/css/leaflet.css");j.type="text/css";j.rel="stylesheet";j.media="screen,print";i=document.createElement("link");i.href=k.relativeUrl("/blocks/gps/css/main.css");i.type="text/css";i.rel="stylesheet";i.media="screen,print";document.getElementsByTagName("head")[0].appendChild(j);document.getElementsByTagName("head")[0].appendChild(i)})};M.availability_gps.form.getNode=function(r){var o,k,s,l,h,q;q=M.str.availability_gps;for(o=0;o<M.availability_gps.vals.length;o++){if(!r[M.availability_gps.vals[o]]){r[M.availability_gps.vals[o]]=0}}var p="require(['block_gps/conditionassistant'], function(helper) { helper.init(true);});";var e="require(['block_gps/conditionassistant'], function(helper) { helper.current(this); });";var i=(r.persistent==1)?' checked="checked"':"";var g=(r.reveal==1)?' checked="checked"':"";var n=(r.revealname==1)?' checked="checked"':"";this.nodesSoFar++;k=[];k.push('<div class="availability_gps">');k.push('    <div class="alert alert-info">'+q.notify_block+"</div>");k.push('    <div class="row">');k.push('        <div class="col-md-2">');k.push('            <a href="#" onclick="'+p+'; return false;" class="btn btn-secondary" style="text-align: center;">');k.push('                <i class="fa fa-map" style="font-size: 30px; vertical-align: middle;"></i><br />');k.push(q.selectfrommap);k.push("            </a>");k.push("        </div>");k.push('        <div class="col-md-5" style="display: flex;">');k.push("            <table>");k.push("                <tr>");k.push("                    <td>"+q.latitude+"</td>");k.push('                    <td><input type="text" name="latitude" value="'+r.latitude+'" size="18" style="width: 100%; max-width: 160px;"/></td>');k.push("                </tr>");k.push("                <tr>");k.push("                    <td>"+q.longitude+"</td>");k.push('                    <td><input type="text" name="longitude" value="'+r.longitude+'" size="18" style="width: 100%; max-width: 160px;"/></td>');k.push("                </tr>");k.push("                <tr>");k.push("                    <td>"+q.accuracy+"</td>");k.push('                    <td><select name="accuracy" style="width: 100%; max-width: 160px;">');var s=[5,10,50,100,500,1000,5000,10000,20000];var d=" "+q.meters;var f=" "+q.kilometers;var j=["5"+d,"10"+d,"50"+d,"100"+d,"500"+d,"1"+f,"5"+f,"10"+f,"20"+f];for(o=0;o<s.length;o++){h=((r.accuracy==s[o])?" selected":"");k.push('       <option value="'+s[o]+'"'+h+"> "+j[o]+"</option>")}k.push("                    </select></td>");k.push("                </tr>");k.push("            </table>");k.push("        </div>");k.push('        <div class="col-md-5">');k.push('            <input name="persistent" type="checkbox"'+i+" /> "+q.persistent+"<br />");k.push('            <input name="reveal" type="checkbox"'+g+" /> "+q.reveal+"<br />");k.push('            <input name="revealname" type="checkbox"'+n+" /> "+q.revealname);k.push("        </div>");k.push("    </div>");k.push('    <div class="hidden" id="availability_gps_map" style="height: 440px; border: 1px solid #AAA;">');k.push('        <div style="position: absolute; z-index: 999; right: 15px; top: 15px;">');k.push('            <a href="#" onclick="'+e+'; return false;" class="btn btn-secondary" style="color: unset;">');k.push('                <i class="fa fa-map-marker"></i>&nbsp;'+q.current_location_set);k.push("            </a>");k.push("        </div>");k.push("    </div>");k.push("</div>");var c=b.Node.create(k.join(""));if(!M.availability_gps.form.addedEvents){M.availability_gps.form.addedEvents=true;var m=b.one("#fitem_id_availabilityconditionsjson");m.delegate("change",function(){M.core_availability.form.update();require(["block_gps/conditionassistant"],function(t){t.initIfShown()})},".availability_gps select");m.delegate("click",function(){M.core_availability.form.update();require(["block_gps/conditionassistant"],function(t){t.initIfShown()})},".availability_gps input[type=checkbox]");m.delegate("valuechange",function(){M.core_availability.form.update();require(["block_gps/conditionassistant"],function(t){t.initIfShown()})},".availability_gps input")}M.availability_gps.node=c;return c};M.availability_gps.form.fillValue=function(f,e){var d,c;for(c=0;c<M.availability_gps.vals.length;c++){var g=M.availability_gps.vals[c];d=e.one("*[name="+g+"]");if(["persistent","reveal","revealname"].indexOf(g)>-1){f[g]=(d.get("checked")?1:0)}else{if(d){f[g]=d.get("value")}}}}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});