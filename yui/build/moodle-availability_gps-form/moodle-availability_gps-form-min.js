YUI.add("moodle-availability_gps-form",function(e,t){M.availability_gps=M.availability_gps||{},M.availability_gps.vals=["accuracy","longitude","latitude","persistent","reveal","revealname"],M.availability_gps.form=e.Object(M.core_availability.plugin),M.availability_gps.form.initInner=function(e,t,n,r,i,s){console.log("initInner: ",e,t,n,r,i,s)},M.availability_gps.form.getNode=function(t){var n,r,i,s,o,u,a,f,l;f=M.str.availability_gps;for(n=0;n<M.availability_gps.vals.length;n++)t[M.availability_gps.vals[n]]||(t[M.availability_gps.vals[n]]=0);i="if (navigator.geolocation) {\n    M.availability_gps.locatebtn = this;\n    M.availability_gps.locatebtn.value = '"+f.loading+"...';\n"+"    navigator.geolocation.getCurrentPosition(\n"+"        function(position){\n"+"            M.availability_gps.locatebtn.value = '"+f.current_location+"';\n"+"            console.log('Position:' , position.coords);\n"+"            M.availability_gps.node.one('[name=longitude]').set('value', position.coords.longitude);\n"+"            M.availability_gps.node.one('[name=latitude]').set('value', position.coords.latitude);\n"+"            M.core_availability.form.update();\n"+"        }\n"+"    );\n"+"} else {\n"+"    M.availability_gps.locatebtn.value = '"+f.geolocation_not_supported+"';\n"+"    //alert('"+f.geolocation_not_supported+"');\n"+"}\n",r='<div class="availability-gps">',r+="<span>"+f.notify_block+"</span>",r+='<span><input type="button" value="'+f.current_location+'" onclick="'+i+'" class="ui-btn btn" /></span>',r+="<span><label>"+f.longitude+' <input type="text" name="longitude" value="'+t.longitude+'"/></label></span>',r+="<span><label>"+f.latitude+' <input type="text" name="latitude" value="'+t.latitude+'"/></label></span>',r+="<span><label>"+f.accuracy+' <select name="accuracy">',s=[5,10,50,100,500,1e3];for(n=0;n<s.length;n++)a=t.accuracy==s[n]?" selected":"",r+='   <option value="'+s[n]+'"'+a+">"+s[n]+" "+f.meters+"</option>";r+="</select></label></span>",r+="<span><label>"+f.persistent+' <select name="persistent">',s=[0,1],o=[f.no,f.yes];for(n=0;n<s.length;n++)a=t.persistent==s[n]?" selected":"",r+='   <option value="'+s[n]+'"'+a+">"+o[n]+"</option>";r+="</select></label></span>",r+="<span><label>"+f.reveal+'<select name="reveal">',s=[0,1],o=[f.no,f.yes];for(n=0;n<s.length;n++)a=t.reveal==s[n]?" selected":"",r+='   <option value="'+s[n]+'"'+a+">"+o[n]+"</option>";r+="</select></label></span>",r+="<span><label>"+f.revealname+'<select name="revealname">',s=[0,1],o=[f.no,f.yes];for(n=0;n<s.length;n++)a=t.revealname==s[n]?" selected":"",r+='   <option value="'+s[n]+'"'+a+">"+o[n]+"</option>";return r+="</select></label></span>",r+="</div>",M.availability_gps.node=e.Node.create(r),M.availability_gps.form.addedEvents||(M.availability_gps.form.addedEvents=!0,u=e.one(".availability-gps"),console.log("Delegating Actions on",u),u&&u.delegate("change",function(){M.core_availability.form.update()},".availability_gps input, .availability_gps select")),M.availability_gps.node},M.availability_gps.form.fillValue=function(e,t){var n,r;for(r=0;r<M.availability_gps.vals.length;r++)n=t.one("*[name="+M.availability_gps.vals[r]+"]"),console.log("Item for ",M.availability_gps.vals[r],n),n&&(e[M.availability_gps.vals[r]]=n.get("value"));console.log("Values to store",e)}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});
